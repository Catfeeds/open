{include file="public/header"}
<body>
	<div class="x-nav">
      <span class="layui-breadcrumb">
        <a href="">首页</a>
        <a href="">会员管理</a>
        <a>
          <cite>充值记录</cite></a>
      </span>
      <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" id="UserShuaxin" href="javascript:location.replace(location.href);" title="刷新">
        <i class="layui-icon" style="line-height:30px">ဂ</i></a>
    </div>
    <br>
<blockquote class="layui-elem-quote layui-text">
<span style="color:#00bcff;">操作提示</span><br>
 &nbsp;&nbsp;&nbsp;&nbsp;用户充值记录列表, 由平台设置管理.</span>
</blockquote>
<br>


<table class="layui-table layui-form" style="width: 98%;margin: 10px auto;">
 <tr>
    <td colspan="10">
    <span class="layui-btn layui-bg-cyan" style="height: 30px;line-height: 30px;" data-type="reload">记录总数:  共 {$data|count} 条</span>
<div class="demoTable layui-form" style="float: right;margin-right: 20px;">
  <div class="layui-inline">
    <input class="layui-input" value="{$start|date='Y-m-d',###}" placeholder="开始日" name="start" id="start">
  </div>
  <div class="layui-inline">
    <input class="layui-input" value="{$end|date='Y-m-d',###}" placeholder="截止日" name="end" id="end">
  </div>
  <div class="layui-inline">
    <input class="layui-input" value="" placeholder="请输出用户名" id="nick" autocomplete="off">
  </div>
  <button class="layui-btn" data-type="reload" id="withdrawals" lay-submit lay-filter="withdrawals">搜索</button>
</div>
    </td>
  </tr>
 <tr>
    <td width="10%">id</td>
    <td>用户名</td>
    <td>账单</td>
    <td>提现金额</td>
    <td>类型</td>
    <td>审批</td>
    <td>提现</td>
    <td>提现说明</td>
    <td>时间</td>
    <td width="20%">操作</td>
  </tr>

  {volist name="data" id="vo"}
	 <tr>
	    <td>{$vo['id']}</td>
      <td>{$vo['user_nick']}</td>
      <td>{$vo['bill']}</td>
      <td>{$vo['money']}</td>
      <td>{$vo['type']}</td>
      <td>{$vo['is_shenpin']}</td>
      <td>{$vo['is_withdrawals']}</td>
      <td>{$vo['tixain_shuoming']}</td>
      <td>{$vo['is_time']|date="Y-m-d h:i:s",###}</td>
      <td>
         <a class="layui-btn layui-btn-primary layui-btn-xs" {if condition="$vo['is_shenpin'] == 2"} onclick="ajaxShenpin(this,{$vo['id']})"{else /} onclick="shenpin()"
         {/if} lay-event="detail">通过审批</a>
      <a class="layui-btn layui-btn-xs" onclick="ajaxWithdList(this,{$vo['id']})" lay-event="capital">查看详情</a>
      </td>
	  </tr>
  {/volist}

</table>
<div id="list2"></div>
<script>
  
   // 数据的集合
var pcountInt = parseInt({$datanum}) ; //总数据
var psizeInt= {$limit}; //页面大小
var curr = {$curr}; //当前页
var ptotalpages=Math.ceil(pcountInt/psizeInt);// 总记录数 

function shenpin(){
  layer.msg('已经审批了，请去提现给用户！！');
}

 function subForm(){
            var bname=$("#text").val();
            var shenpi=$("input[name='shenpi']:checked").val();

          }
  /**
       * 弹出一个输入框，输入审批内容，以及审批的结果
       * ajax 提交审批
       */
  function ajaxShenpin(obj,id){

     var html  = '<from action="/admin/user/okokoko/"><input type="radio" style="margin-left:20px;cursor: pointer;" name="shenpi" value="1"  id="radio1" checked><label for="radio1" style="padding-left: 8px;padding-right: 8px;font-size: 16px;font-weight: bold;cursor: pointer;">审批通过</label><input type="radio" name="shenpi" value="2" id="radio2" style="cursor: pointer;"><label for="radio2" style="padding-left: 8px;cursor: pointer;padding-right: 8px;font-size: 16px;font-weight: bold;">审批未通过</label><br/><br/><textarea name="text" id="text" required lay-verify="required" placeholder="请输入" class="layui-textarea"></textarea><br><div style="width: 100%;text-align: center;"></div></from>';
        layer.open({
          title: '在线调试'
          ,content: html
          ,resize:false
          ,area: ['500px', '300px']
          ,btn: ['提交','取消']
          ,yes: function(index, layero){
              subForm()
          },btn1: function(index, layero){
            layer.close(index);
          }
        });     
    
   
        
  }


  layui.use(['laypage','form','layer','laydate'], function(){
  var laypage = layui.laypage,
  layer = layui.layer,
  laydate = layui.laydate;

//执行一个laydate实例
        laydate.render({
          elem: '#start' //指定元素
        });

        //执行一个laydate实例
        laydate.render({
          elem: '#end' //指定元素
        });
// 分页组件
  laypage.render({
    elem: 'list2', // div的id号
    count: pcountInt,  // 数据的总数，后端获取
    limit: psizeInt,  // 分页
    layout: ['count','prev','page','next','limit','refresh','skip'],
    limits: [10,20,30,100],
    pages: ptotalpages,
    curr: curr,
    jump:function(obj,first){
      if (!first) {
        var curr = obj.curr;
        window.location.href = "/admin/user/withdrawals?limit="+obj.limit+"&curr="+curr+"&nick="+"{$nick}";
      }
    }
  })

    
}); 

</script>
<script>
  
  $(function(){
    $('#withdrawals').click(function(){
      window.location.href = "/admin/User/withdrawals?nick="+$('.nick').val();
    })
    $('#ShenpiSub').click(function(){
      alert('12345');
    })
  })

</script>

</body>
</html>